/* eslint-disable @typescript-eslint/no-unused-vars */
/* eslint-disable @typescript-eslint/no-var-requires */
/* eslint-disable prefer-rest-params */
/* eslint-disable @typescript-eslint/triple-slash-reference */
/// <reference path="globals.d.ts" />
String.prototype.printf = function (obj) {
    /*const isNode = new Function(
      "try {return this===global;}catch(e){return false;}"
    );
  
    if (isNode()) {
      const util = require("util");
      return util.format(this, obj);
    }*/
    let useArguments = false;
    const _arguments = arguments;
    let i = -1;
    if (typeof _arguments[0] == 'string') {
        useArguments = true;
    }
    if (obj instanceof Array || useArguments) {
        return this.replace(/%s/g, function (a, b) {
            i++;
            if (useArguments) {
                if (typeof _arguments[i] == 'string') {
                    return _arguments[i];
                }
                else {
                    throw new Error('Arguments element is an invalid type');
                }
            }
            return obj[i];
        });
    }
    else {
        return this.replace(/{([^{}]*)}/g, function (a, b) {
            const r = obj[b];
            return typeof r === 'string' || typeof r === 'number' ? r : a;
        });
    }
};
String.prototype.parse_url = function () {
    let parser;
    if (typeof module != 'undefined' && module.exports) {
        parser = new URL(this);
    }
    else if (typeof document != 'undefined') {
        parser = document.createElement('a');
    }
    const searchObject = [];
    let split = [];
    let queries = [];
    // Let the browser do the work
    parser.href = this.toString();
    // Convert query string to object
    queries = parser.search.replace(/^\?/, '').split('&');
    for (let i = 0; i < queries.length; i++) {
        split = queries[i].split('=');
        if (split.length)
            searchObject[split[0]] = split[1];
    }
    return {
        protocol: parser.protocol,
        host: parser.host,
        hostname: parser.hostname,
        port: parser.port,
        pathname: parser.pathname,
        search: parser.search,
        searchObject: searchObject,
        hash: parser.hash,
        protohost: parser.protocol + '//' + parser.host,
    };
};
/**
 * Load css
 */
String.prototype.CSS = function () {
    const e = document.createElement('link');
    e.rel = 'stylesheet';
    e.href = this.toString();
    const n = document.getElementsByTagName('head')[0];
    window.addEventListener
        ? window.addEventListener('load', function () {
            n.parentNode.insertBefore(e, n);
        }, !1)
        : window.attachEvent
            ? window.attachEvent('onload', function () {
                n.parentNode.insertBefore(e, n);
            })
            : (window.onload = function () {
                n.parentNode.insertBefore(e, n);
            });
};
String.prototype.trim = function () {
    return this.replace(/^\s+|\s+$/gm, '');
};
String.prototype.hexE = function () {
    let hex, i;
    let result = '';
    for (i = 0; i < this.length; i++) {
        hex = this.charCodeAt(i).toString(16);
        result += ('000' + hex).slice(-4);
    }
    return result;
};
String.prototype.hexD = function () {
    let j;
    const hexes = this.match(/.{1,4}/g) || [];
    let back = '';
    for (j = 0; j < hexes.length; j++) {
        back += String.fromCharCode(parseInt(hexes[j], 16));
    }
    return back;
};
String.prototype.capitalize = function () {
    return this.charAt(0).toUpperCase() + this.slice(1);
};
String.prototype.rot13 = function () {
    return this.replace(/[a-zA-Z]/g, function (c) {
        return String.fromCharCode((c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26);
    });
};
String.prototype.truncate = function (n, useWordBoundary) {
    if (this.length <= n) {
        return this;
    }
    const subString = this.substr(0, n - 1); // the original check
    return (useWordBoundary ? subString.substr(0, subString.lastIndexOf(' ')) : subString) + '&hellip;';
};
String.prototype.isEmpty = function () {
    if (this != null || typeof this != 'undefined') {
        return this.length === 0 || !this.trim();
    }
    return false;
};
String.prototype.replaceArr = function (array, replacement) {
    // eslint-disable-next-line @typescript-eslint/no-this-alias
    let ori = this;
    array.map((str) => {
        ori = ori.replace(str, replacement);
    });
    return ori;
};
String.prototype.toHtmlEntities = function () {
    return this.replace(/./gm, function (s) {
        // return "&#" + s.charCodeAt(0) + ";";
        return s.match(/[a-z0-9\s]+/i) ? s : '&#' + s.charCodeAt(0) + ';';
    });
};
String.fromHtmlEntities = function (str) {
    return (str + '').replace(/&#\d+;/gm, function (s) {
        const m = s.match(/\d+/gm)[0];
        return String.fromCharCode(m);
    });
};
String.prototype.includesArray = function (substrings) {
    return substrings.some((v) => this.includes(v));
};
if (typeof ''.replaceAll != 'function') {
    String.prototype.replaceAll = function (search, replacement) {
        const find = typeof search == 'string' ? new RegExp(search, 'g') : search;
        return this.replace(find, replacement);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RyaW5nLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL1N0cmluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxzREFBc0Q7QUFDdEQsdURBQXVEO0FBQ3ZELHVDQUF1QztBQUN2Qyw4REFBOEQ7QUFDOUQscUNBQXFDO0FBMkpyQyxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxVQUFVLEdBQUc7SUFDckM7Ozs7Ozs7T0FPRztJQUVILElBQUksWUFBWSxHQUFHLEtBQUssQ0FBQztJQUN6QixNQUFNLFVBQVUsR0FBRyxTQUFTLENBQUM7SUFDN0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDWCxJQUFJLE9BQU8sVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLFFBQVEsRUFBRTtRQUNwQyxZQUFZLEdBQUcsSUFBSSxDQUFDO0tBQ3JCO0lBQ0QsSUFBSSxHQUFHLFlBQVksS0FBSyxJQUFJLFlBQVksRUFBRTtRQUN4QyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLFVBQVUsQ0FBQyxFQUFFLENBQUM7WUFDdkMsQ0FBQyxFQUFFLENBQUM7WUFDSixJQUFJLFlBQVksRUFBRTtnQkFDaEIsSUFBSSxPQUFPLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxRQUFRLEVBQUU7b0JBQ3BDLE9BQU8sVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO2lCQUN0QjtxQkFBTTtvQkFDTCxNQUFNLElBQUksS0FBSyxDQUFDLHNDQUFzQyxDQUFDLENBQUM7aUJBQ3pEO2FBQ0Y7WUFDRCxPQUFPLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoQixDQUFDLENBQUMsQ0FBQztLQUNKO1NBQU07UUFDTCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLFVBQVUsQ0FBQyxFQUFFLENBQUM7WUFDL0MsTUFBTSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pCLE9BQU8sT0FBTyxD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QUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlCLE9BQU8sTUFBTSxDQUFDLFlBQVksQ0FBTSxDQUFDLENBQUMsQ0FBQztJQUNyQyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxTQUFTLENBQUMsYUFBYSxHQUFHLFVBQVUsVUFBVTtJQUNuRCxPQUFPLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNsRCxDQUFDLENBQUM7QUFFRixJQUFJLE9BQU8sRUFBRSxDQUFDLFVBQVUsSUFBSSxVQUFVLEVBQUU7SUFDdEMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxVQUFVLEdBQUcsVUFBVSxNQUFNLEVBQUUsV0FBVztRQUN6RCxNQUFNLElBQUksR0FBRyxPQUFPLE1BQU0sSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUksTUFBTSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO1FBQzFFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUM7SUFDekMsQ0FBQyxDQUFDO0NBQ0giLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnMgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby12YXItcmVxdWlyZXMgKi9cbi8qIGVzbGludC1kaXNhYmxlIHByZWZlci1yZXN0LXBhcmFtcyAqL1xuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L3RyaXBsZS1zbGFzaC1yZWZlcmVuY2UgKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJnbG9iYWxzLmQudHNcIiAvPlxuXG4vKipcbiAqIFN0cmluZ3NcbiAqL1xuaW50ZXJmYWNlIFN0cmluZyB7XG4gIC8qKlxuICAgKiBUcnVuY2F0ZSBzdHJpbmdcbiAgICogQHBhcmFtIG4gc2VxdWVuY2UgbnVtYmVyIHRvIGN1dCB0aGUgbmV4dCBzZW50ZW5jZVxuICAgKiBAcGFyYW0gdXNlV29yZEJvdW5kYXJ5IHRydWUgPyBzdWJTdHJpbmcuc3Vic3RyKDAsIHN1YlN0cmluZy5sYXN0SW5kZXhPZihcIiBcIikpXG4gICAqIEBzZWUgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTE5OTM1Mi9zbWFydC13YXktdG8tdHJ1bmNhdGUtbG9uZy1zdHJpbmdzXG4gICAqL1xuICB0cnVuY2F0ZTogKG46IG51bWJlciwgdXNlV29yZEJvdW5kYXJ5OiBib29sZWFuIHwgbnVsbCkgPT4gc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBSZXBsYWNlIGFsbCBvY2N1cnJlbmNlcyBvZiBhIHN0cmluZ1xuICAgKiAqIFNoaW0gRVMyMDIxIHByb3RvdHlwZVxuICAgKiBAc2VlIHtAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9TdHJpbmcvcmVwbGFjZUFsbH1cbiAgICovXG4gIHJlcGxhY2VBbGw6IChzZWFyY2g6IHN0cmluZyB8IFJlZ0V4cCwgcmVwbGFjZW1lbnQ6IHN0cmluZykgPT4gc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBQcmludGZcbiAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzQ2MDc4Mzc1fVxuICAgKiBAZXhhbXBsZVxuICAgKiBjb25zb2xlLmxvZyhcIkhlbGxvIEkgYW0gXCIgKyBcIiVzICVzXCIucHJpbnRmKFtcImZvb1wiLCBcImJhclwiXSkpO1xuICAgKi9cbiAgcHJpbnRmOiAob2JqOiBhbnlbXSB8IHN0cmluZykgPT4gc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBNYXRjaGVzIGEgc3RyaW5nIGFuIG9iamVjdCB0aGF0IHN1cHBvcnRzIGJlaW5nIG1hdGNoZWQgYWdhaW5zdCwgYW5kIHJldHVybnMgYW4gYXJyYXkgY29udGFpbmluZyB0aGUgcmVzdWx0cyBvZlxuICAgKiB0aGF0IHNlYXJjaC5cbiAgICogQHBhcmFtIG1hdGNoZXIgQW4gb2JqZWN0IHRoYXQgc3VwcG9ydHMgYmVpbmcgbWF0Y2hlZCBhZ2FpbnN0LlxuICAgKi9cbiAgbWF0Y2gobWF0Y2hlcjogeyBbU3ltYm9sLm1hdGNoXShzdHJpbmc6IHN0cmluZyk6IFJlZ0V4cE1hdGNoQXJyYXkgfCBudWxsIH0pOiBSZWdFeHBNYXRjaEFycmF5IHwgbnVsbDtcblxuICAvKipcbiAgICogUmVwbGFjZXMgdGV4dCBpbiBhIHN0cmluZywgdXNpbmcgYW4gb2JqZWN0IHRoYXQgc3VwcG9ydHMgcmVwbGFjZW1lbnQgd2l0aGluIGEgc3RyaW5nLlxuICAgKiBAcGFyYW0gc2VhcmNoVmFsdWUgQSBvYmplY3QgY2FuIHNlYXJjaCBmb3IgYW5kIHJlcGxhY2UgbWF0Y2hlcyB3aXRoaW4gYSBzdHJpbmcuXG4gICAqIEBwYXJhbSByZXBsYWNlVmFsdWUgQSBzdHJpbmcgY29udGFpbmluZyB0aGUgdGV4dCB0byByZXBsYWNlIGZvciBldmVyeSBzdWNjZXNzZnVsIG1hdGNoIG9mIHNlYXJjaFZhbHVlIGluIHRoaXNcbiAgICogICAgIHN0cmluZy5cbiAgICovXG4gIHJlcGxhY2UoXG4gICAgc2VhcmNoVmFsdWU6IHtcbiAgICAgIFtTeW1ib2wucmVwbGFjZV0oc3RyaW5nOiBzdHJpbmcsIHJlcGxhY2VWYWx1ZTogc3RyaW5nKTogc3RyaW5nO1xuICAgIH0sXG4gICAgcmVwbGFjZVZhbHVlOiBzdHJpbmdcbiAgKTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBSZXBsYWNlcyB0ZXh0IGluIGEgc3RyaW5nLCB1c2luZyBhbiBvYmplY3QgdGhhdCBzdXBwb3J0cyByZXBsYWNlbWVudCB3aXRoaW4gYSBzdHJpbmcuXG4gICAqIEBwYXJhbSBzZWFyY2hWYWx1ZSBBIG9iamVjdCBjYW4gc2VhcmNoIGZvciBhbmQgcmVwbGFjZSBtYXRjaGVzIHdpdGhpbiBhIHN0cmluZy5cbiAgICogQHBhcmFtIHJlcGxhY2VyIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSByZXBsYWNlbWVudCB0ZXh0LlxuICAgKi9cbiAgcmVwbGFjZShcbiAgICBzZWFyY2hWYWx1ZToge1xuICAgICAgW1N5bWJvbC5yZXBsYWNlXShzdHJpbmc6IHN0cmluZywgcmVwbGFjZXI6IChzdWJzdHJpbmc6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+IHN0cmluZyk6IHN0cmluZztcbiAgICB9LFxuICAgIHJlcGxhY2VyOiAoc3Vic3RyaW5nOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PiBzdHJpbmdcbiAgKTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBGaW5kcyB0aGUgZmlyc3Qgc3Vic3RyaW5nIG1hdGNoIGluIGEgcmVndWxhciBleHByZXNzaW9uIHNlYXJjaC5cbiAgICogQHBhcmFtIHNlYXJjaGVyIEFuIG9iamVjdCB3aGljaCBzdXBwb3J0cyBzZWFyY2hpbmcgd2l0aGluIGEgc3RyaW5nLlxuICAgKi9cbiAgc2VhcmNoKHNlYXJjaGVyOiB7IFtTeW1ib2wuc2VhcmNoXShzdHJpbmc6IHN0cmluZyk6IG51bWJlciB9KTogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBTcGxpdCBhIHN0cmluZyBpbnRvIHN1YnN0cmluZ3MgdXNpbmcgdGhlIHNwZWNpZmllZCBzZXBhcmF0b3IgYW5kIHJldHVybiB0aGVtIGFzIGFuIGFycmF5LlxuICAgKiBAcGFyYW0gc3BsaXR0ZXIgQW4gb2JqZWN0IHRoYXQgY2FuIHNwbGl0IGEgc3RyaW5nLlxuICAgKiBAcGFyYW0gbGltaXQgQSB2YWx1ZSB1c2VkIHRvIGxpbWl0IHRoZSBudW1iZXIgb2YgZWxlbWVudHMgcmV0dXJuZWQgaW4gdGhlIGFycmF5LlxuICAgKi9cbiAgc3BsaXQoc3BsaXR0ZXI6IHsgW1N5bWJvbC5zcGxpdF0oc3RyaW5nOiBzdHJpbmcsIGxpbWl0PzogbnVtYmVyKTogc3RyaW5nW10gfSwgbGltaXQ/OiBudW1iZXIpOiBzdHJpbmdbXTtcblxuICAvKipcbiAgICogUGFyc2UgdXJsIGludG8gcGFydCBvYmplY3RcbiAgICovXG4gIHBhcnNlX3VybCgpOiB7XG4gICAgcHJvdG9jb2w6IHN0cmluZztcbiAgICBob3N0OiBzdHJpbmc7XG4gICAgaG9zdG5hbWU6IHN0cmluZztcbiAgICBwb3J0OiBzdHJpbmc7XG4gICAgcGF0aG5hbWU6IHN0cmluZztcbiAgICBzZWFyY2g6IHN0cmluZztcbiAgICBzZWFyY2hPYmplY3Q6IFJlY29yZDxhbnksIGFueT47XG4gICAgaGFzaDogc3RyaW5nO1xuICAgIHByb3RvaG9zdDogc3RyaW5nO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDYWxsIGNzcyBmcm9tIHVybC9wYXRoXG4gICAqL1xuICBDU1MoKTogdm9pZDtcblxuICAvKipcbiAgICogSGV4IGVuY3J5cHRcbiAgICovXG4gIGhleEUoKTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBIZXggRGVjcnlwdFxuICAgKi9cbiAgaGV4RCgpOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIENhcGl0YWxpemUgYWxsIGZpcnN0IGNoYXJhY3RlciBzdHJpbmdcbiAgICogQGV4YW1wbGUgW1BIUF0gdWN3b3Jkcygkc3RyaW5nKVxuICAgKi9cbiAgY2FwaXRhbGl6ZSgpOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFBIUCBzdHJfcm90MTMgZXF1aXZhbGVudFxuICAgKi9cbiAgcm90MTMoKTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBzdHJpbmcgZW1wdHkgb3IgYmxhbmtcbiAgICovXG4gIGlzRW1wdHkoKTogYm9vbGVhbjtcblxuICAvKipcbiAgICogUmVwbGFjZSBzdHJpbmcgYnkgYXJyYXkgcGF0dGVyblxuICAgKiBAcGFyYW0gYXJyYXlcbiAgICogQHBhcmFtIHJlcGxhY2VtZW50XG4gICAqL1xuICByZXBsYWNlQXJyKGFycmF5OiBzdHJpbmdbXSwgcmVwbGFjZW1lbnQ6IHN0cmluZyk6IHN0cmluZztcblxuICAvKipcbiAgICogQ29udmVydCBhIHN0cmluZyB0byBIVE1MIGVudGl0aWVzXG4gICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yNzAyMDMwMH1cbiAgICogQGV4YW1wbGVcbiAgICogXCJUZXN0wrTigKDCrsKlwqjCqcuZ4oirw7jigKbLhsaS4oiGw7fiiJHihKLGkuKIhsOmw7jPgMKjwqggxpLihKJlbiB0w6lzdFwiLnRvSHRtbEVudGl0aWVzKCk7XG4gICAqIGNvbnNvbGUubG9nKFwiRW50aXRpZXM6XCIsIHN0cik7XG4gICAqL1xuICB0b0h0bWxFbnRpdGllcygpOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHN0cmluZyBjb250YWlucyBzb21lIHRleHQgZnJvbSBhcnJheSBvZiBzdWJzdHJpbmdzXG4gICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS81NTgyNjIxfVxuICAgKiBAcGFyYW0gYXJyYXlTdHJcbiAgICovXG4gIGluY2x1ZGVzQXJyYXkoYXJyYXlTdHI6IHN0cmluZ1tdKTogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIFN0cmluZ0NvbnN0cnVjdG9yIHtcbiAgLyoqXG4gICAqIENyZWF0ZSBzdHJpbmcgZnJvbSBIVE1MIGVudGl0aWVzXG4gICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yNzAyMDMwMH1cbiAgICogQGV4YW1wbGVcbiAgICogdmFyIHN0ciA9IFwiVGVzdMK04oCgwq7CpcKowqnLmeKIq8O44oCmy4bGkuKIhsO34oiR4oSixpLiiIbDpsO4z4DCo8KoIMaS4oSiZW4gdMOpc3RcIi50b0h0bWxFbnRpdGllcygpO1xuICAgKiBjb25zb2xlLmxvZyhcIlN0cmluZzpcIiwgU3RyaW5nLmZyb21IdG1sRW50aXRpZXMoc3RyKSk7XG4gICAqL1xuICBmcm9tSHRtbEVudGl0aWVzKHN0cjogc3RyaW5nKTogc3RyaW5nO1xufVxuXG5TdHJpbmcucHJvdG90eXBlLnByaW50ZiA9IGZ1bmN0aW9uIChvYmopIHtcbiAgLypjb25zdCBpc05vZGUgPSBuZXcgRnVuY3Rpb24oXG4gICAgXCJ0cnkge3JldHVybiB0aGlzPT09Z2xvYmFsO31jYXRjaChlKXtyZXR1cm4gZmFsc2U7fVwiXG4gICk7XG5cbiAgaWYgKGlzTm9kZSgpKSB7XG4gICAgY29uc3QgdXRpbCA9IHJlcXVpcmUoXCJ1dGlsXCIpO1xuICAgIHJldHVybiB1dGlsLmZvcm1hdCh0aGlzLCBvYmopO1xuICB9Ki9cblxuICBsZXQgdXNlQXJndW1lbnRzID0gZmFsc2U7XG4gIGNvbnN0IF9hcmd1bWVudHMgPSBhcmd1bWVudHM7XG4gIGxldCBpID0gLTE7XG4gIGlmICh0eXBlb2YgX2FyZ3VtZW50c1swXSA9PSAnc3RyaW5nJykge1xuICAgIHVzZUFyZ3VtZW50cyA9IHRydWU7XG4gIH1cbiAgaWYgKG9iaiBpbnN0YW5jZW9mIEFycmF5IHx8IHVzZUFyZ3VtZW50cykge1xuICAgIHJldHVybiB0aGlzLnJlcGxhY2UoLyVzL2csIGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICBpKys7XG4gICAgICBpZiAodXNlQXJndW1lbnRzKSB7XG4gICAgICAgIGlmICh0eXBlb2YgX2FyZ3VtZW50c1tpXSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgIHJldHVybiBfYXJndW1lbnRzW2ldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQXJndW1lbnRzIGVsZW1lbnQgaXMgYW4gaW52YWxpZCB0eXBlJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvYmpbaV07XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHRoaXMucmVwbGFjZSgveyhbXnt9XSopfS9nLCBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgY29uc3QgciA9IG9ialtiXTtcbiAgICAgIHJldHVybiB0eXBlb2YgciA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHIgPT09ICdudW1iZXInID8gciA6IGE7XG4gICAgfSk7XG4gIH1cbn07XG5cblN0cmluZy5wcm90b3R5cGUucGFyc2VfdXJsID0gZnVuY3Rpb24gKCkge1xuICBsZXQgcGFyc2VyOiBVUkwgfCBIVE1MQW5jaG9yRWxlbWVudDtcbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBwYXJzZXIgPSBuZXcgVVJMKHRoaXMpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkb2N1bWVudCAhPSAndW5kZWZpbmVkJykge1xuICAgIHBhcnNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgfVxuICBjb25zdCBzZWFyY2hPYmplY3Q6IEFycmF5PFJlY29yZDxhbnksIGFueT4gfCBhbnk+ID0gW107XG4gIGxldCBzcGxpdDogQXJyYXk8UmVjb3JkPGFueSwgYW55PiB8IGFueT4gPSBbXTtcbiAgbGV0IHF1ZXJpZXM6IHN0cmluZ1tdID0gW107XG4gIC8vIExldCB0aGUgYnJvd3NlciBkbyB0aGUgd29ya1xuICBwYXJzZXIuaHJlZiA9IHRoaXMudG9TdHJpbmcoKTtcbiAgLy8gQ29udmVydCBxdWVyeSBzdHJpbmcgdG8gb2JqZWN0XG4gIHF1ZXJpZXMgPSBwYXJzZXIuc2VhcmNoLnJlcGxhY2UoL15cXD8vLCAnJykuc3BsaXQoJyYnKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBxdWVyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgc3BsaXQgPSBxdWVyaWVzW2ldLnNwbGl0KCc9Jyk7XG4gICAgaWYgKHNwbGl0Lmxlbmd0aCkgc2VhcmNoT2JqZWN0W3NwbGl0WzBdXSA9IHNwbGl0WzFdO1xuICB9XG4gIHJldHVybiB7XG4gICAgcHJvdG9jb2w6IHBhcnNlci5wcm90b2NvbCxcbiAgICBob3N0OiBwYXJzZXIuaG9zdCxcbiAgICBob3N0bmFtZTogcGFyc2VyLmhvc3RuYW1lLFxuICAgIHBvcnQ6IHBhcnNlci5wb3J0LFxuICAgIHBhdGhuYW1lOiBwYXJzZXIucGF0aG5hbWUsXG4gICAgc2VhcmNoOiBwYXJzZXIuc2VhcmNoLFxuICAgIHNlYXJjaE9iamVjdDogc2VhcmNoT2JqZWN0LFxuICAgIGhhc2g6IHBhcnNlci5oYXNoLFxuICAgIHByb3RvaG9zdDogcGFyc2VyLnByb3RvY29sICsgJy8vJyArIHBhcnNlci5ob3N0LFxuICB9O1xufTtcblxuLyoqXG4gKiBMb2FkIGNzc1xuICovXG5TdHJpbmcucHJvdG90eXBlLkNTUyA9IGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgZS5yZWwgPSAnc3R5bGVzaGVldCc7XG5cbiAgZS5ocmVmID0gdGhpcy50b1N0cmluZygpO1xuICBjb25zdCBuID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXJcbiAgICA/IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAnbG9hZCcsXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBuLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGUsIG4pO1xuICAgICAgICB9LFxuICAgICAgICAhMVxuICAgICAgKVxuICAgIDogd2luZG93LmF0dGFjaEV2ZW50XG4gICAgPyB3aW5kb3cuYXR0YWNoRXZlbnQoJ29ubG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLCBuKTtcbiAgICAgIH0pXG4gICAgOiAod2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLCBuKTtcbiAgICAgIH0pO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS50cmltID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nbSwgJycpO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS5oZXhFID0gZnVuY3Rpb24gKCkge1xuICBsZXQgaGV4OiBzdHJpbmcsIGk6IG51bWJlcjtcblxuICBsZXQgcmVzdWx0ID0gJyc7XG4gIGZvciAoaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG4gICAgaGV4ID0gdGhpcy5jaGFyQ29kZUF0KGkpLnRvU3RyaW5nKDE2KTtcbiAgICByZXN1bHQgKz0gKCcwMDAnICsgaGV4KS5zbGljZSgtNCk7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS5oZXhEID0gZnVuY3Rpb24gKCkge1xuICBsZXQgajogbnVtYmVyO1xuICBjb25zdCBoZXhlcyA9IHRoaXMubWF0Y2goLy57MSw0fS9nKSB8fCBbXTtcbiAgbGV0IGJhY2sgPSAnJztcbiAgZm9yIChqID0gMDsgaiA8IGhleGVzLmxlbmd0aDsgaisrKSB7XG4gICAgYmFjayArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGhleGVzW2pdLCAxNikpO1xuICB9XG5cbiAgcmV0dXJuIGJhY2s7XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLmNhcGl0YWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGhpcy5zbGljZSgxKTtcbn07XG5cblN0cmluZy5wcm90b3R5cGUucm90MTMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLnJlcGxhY2UoL1thLXpBLVpdL2csIGZ1bmN0aW9uIChjOiBhbnkpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyA8PSAnWicgPyA5MCA6IDEyMikgPj0gKGMgPSBjLmNoYXJDb2RlQXQoMCkgKyAxMykgPyBjIDogYyAtIDI2KTtcbiAgfSk7XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLnRydW5jYXRlID0gZnVuY3Rpb24gKG46IG51bWJlciwgdXNlV29yZEJvdW5kYXJ5OiBib29sZWFuIHwgbnVsbCkge1xuICBpZiAodGhpcy5sZW5ndGggPD0gbikge1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIGNvbnN0IHN1YlN0cmluZyA9IHRoaXMuc3Vic3RyKDAsIG4gLSAxKTsgLy8gdGhlIG9yaWdpbmFsIGNoZWNrXG4gIHJldHVybiAodXNlV29yZEJvdW5kYXJ5ID8gc3ViU3RyaW5nLnN1YnN0cigwLCBzdWJTdHJpbmcubGFzdEluZGV4T2YoJyAnKSkgOiBzdWJTdHJpbmcpICsgJyZoZWxsaXA7Jztcbn07XG5cblN0cmluZy5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMgIT0gbnVsbCB8fCB0eXBlb2YgdGhpcyAhPSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiB0aGlzLmxlbmd0aCA9PT0gMCB8fCAhdGhpcy50cmltKCk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlQXJyID0gZnVuY3Rpb24gKHRoaXM6IHN0cmluZywgYXJyYXk6IHN0cmluZ1tdLCByZXBsYWNlbWVudDogc3RyaW5nKSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhc1xuICBsZXQgb3JpID0gdGhpcztcbiAgYXJyYXkubWFwKChzdHIpID0+IHtcbiAgICBvcmkgPSBvcmkucmVwbGFjZShzdHIsIHJlcGxhY2VtZW50KTtcbiAgfSk7XG4gIHJldHVybiBvcmk7XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLnRvSHRtbEVudGl0aWVzID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5yZXBsYWNlKC8uL2dtLCBmdW5jdGlvbiAocykge1xuICAgIC8vIHJldHVybiBcIiYjXCIgKyBzLmNoYXJDb2RlQXQoMCkgKyBcIjtcIjtcbiAgICByZXR1cm4gcy5tYXRjaCgvW2EtejAtOVxcc10rL2kpID8gcyA6ICcmIycgKyBzLmNoYXJDb2RlQXQoMCkgKyAnOyc7XG4gIH0pO1xufTtcblxuU3RyaW5nLmZyb21IdG1sRW50aXRpZXMgPSBmdW5jdGlvbiAoc3RyKSB7XG4gIHJldHVybiAoc3RyICsgJycpLnJlcGxhY2UoLyYjXFxkKzsvZ20sIGZ1bmN0aW9uIChzKSB7XG4gICAgY29uc3QgbSA9IHMubWF0Y2goL1xcZCsvZ20pWzBdO1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKDxhbnk+bSk7XG4gIH0pO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS5pbmNsdWRlc0FycmF5ID0gZnVuY3Rpb24gKHN1YnN0cmluZ3MpIHtcbiAgcmV0dXJuIHN1YnN0cmluZ3Muc29tZSgodikgPT4gdGhpcy5pbmNsdWRlcyh2KSk7XG59O1xuXG5pZiAodHlwZW9mICcnLnJlcGxhY2VBbGwgIT0gJ2Z1bmN0aW9uJykge1xuICBTdHJpbmcucHJvdG90eXBlLnJlcGxhY2VBbGwgPSBmdW5jdGlvbiAoc2VhcmNoLCByZXBsYWNlbWVudCkge1xuICAgIGNvbnN0IGZpbmQgPSB0eXBlb2Ygc2VhcmNoID09ICdzdHJpbmcnID8gbmV3IFJlZ0V4cChzZWFyY2gsICdnJykgOiBzZWFyY2g7XG4gICAgcmV0dXJuIHRoaXMucmVwbGFjZShmaW5kLCByZXBsYWNlbWVudCk7XG4gIH07XG59XG4iXX0=